::ng-deep .popover-panel {
  .popover-content {
    --pointer-offset: 50%; // Default to center
    background: white;
    border-radius: 12px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
    border: 1px solid rgba(0, 0, 0, 0.08);
    padding: 16px;
    font-family: 'Roboto', sans-serif;
    color: rgba(0, 0, 0, 0.87);
    animation: popoverFadeIn 0.2s cubic-bezier(0.4, 0.0, 0.2, 1);
    overflow: hidden;
    min-width: 200px;
    position: relative;
    
    // Pointer styles - immediately visible
    &:before,
    &:after {
      content: '';
      position: absolute;
      z-index: 20;
    }
    
    // Bottom placement (pointer points up from bottom of popover)
    &[data-placement="bottom"] {
      transform-origin: top center;
      
      &:before {
        top: -8px;
        left: var(--pointer-offset);
        transform: translateX(-50%);
        width: 0;
        height: 0;
        border-left: 8px solid transparent;
        border-right: 8px solid transparent;
        border-bottom: 8px solid white;
        filter: drop-shadow(0 -2px 4px rgba(0, 0, 0, 0.1));
      }
      
      &:after {
        top: -9px;
        left: var(--pointer-offset);
        transform: translateX(-50%);
        width: 0;
        height: 0;
        border-left: 9px solid transparent;
        border-right: 9px solid transparent;
        border-bottom: 9px solid rgba(0, 0, 0, 0.08);
        z-index: 1;
      }
    }
    
    // Top placement (pointer points down from top of popover)
    &[data-placement="top"] {
      transform-origin: bottom center;
      
      &:before {
        bottom: -8px;
        left: var(--pointer-offset);
        transform: translateX(-50%);
        width: 0;
        height: 0;
        border-left: 8px solid transparent;
        border-right: 8px solid transparent;
        border-top: 8px solid white;
        filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
      }
      
      &:after {
        bottom: -9px;
        left: var(--pointer-offset);
        transform: translateX(-50%);
        width: 0;
        height: 0;
        border-left: 9px solid transparent;
        border-right: 9px solid transparent;
        border-top: 9px solid rgba(0, 0, 0, 0.08);
        z-index: 1;
      }
    }
    
    // Right placement (pointer points left from right of popover)
    &[data-placement="right"] {
      transform-origin: center left;
      
      &:before {
        left: -8px;
        top: var(--pointer-offset);
        transform: translateY(-50%);
        width: 0;
        height: 0;
        border-top: 8px solid transparent;
        border-bottom: 8px solid transparent;
        border-right: 8px solid white;
        filter: drop-shadow(-2px 0 4px rgba(0, 0, 0, 0.1));
      }
      
      &:after {
        left: -9px;
        top: var(--pointer-offset);
        transform: translateY(-50%);
        width: 0;
        height: 0;
        border-top: 9px solid transparent;
        border-bottom: 9px solid transparent;
        border-right: 9px solid rgba(0, 0, 0, 0.08);
        z-index: 1;
      }
    }
    
    // Left placement (pointer points right from left of popover)
    &[data-placement="left"] {
      transform-origin: center right;
      
      &:before {
        right: -8px;
        top: var(--pointer-offset);
        transform: translateY(-50%);
        width: 0;
        height: 0;
        border-top: 8px solid transparent;
        border-bottom: 8px solid transparent;
        border-left: 8px solid white;
        filter: drop-shadow(2px 0 4px rgba(0, 0, 0, 0.1));
      }
      
      &:after {
        right: -9px;
        top: var(--pointer-offset);
        transform: translateY(-50%);
        width: 0;
        height: 0;
        border-top: 9px solid transparent;
        border-bottom: 9px solid transparent;
        border-left: 9px solid rgba(0, 0, 0, 0.08);
        z-index: 1;
      }
    }
  }
}

@keyframes popoverFadeIn {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

// Animation for closing
::ng-deep .cdk-overlay-pane.popover-panel.ng-animating {
  .popover-content {
    animation: popoverFadeOut 0.15s cubic-bezier(0.4, 0.0, 1, 1);
  }
}

@keyframes popoverFadeOut {
  from {
    opacity: 1;
    transform: scale(1);
  }
  to {
    opacity: 0;
    transform: scale(0.95);
  }
}
